<?define Name = "ThermalSim" ?>
<?define Manufacturer = "ThermalSim" ?>
<?define Version = "1.0.0.0" ?>
<?define UpgradeCode = "9ED3FF33-8718-444E-B44B-69A2344B7E98" ?>

<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">
	<Package Name="$(Name)"
             Manufacturer="$(Manufacturer)"
             Version="$(Version)"
             UpgradeCode="$(var.UpgradeCode)"
             Compressed="true">

		<!-- Allow upgrades and prevent downgrades -->
		<MajorUpgrade DowngradeErrorMessage="A later version of [ProductName] is already installed. Setup will now exit." />

		<Files Include="..\ThermalSim.Api\bin\Release\net8.0-windows\**">
		</Files>

		<!-- Create a single component which is the App.WindowsService.exe file -->
		<Component Id="ServiceExecutable" Bitness="always64" Guid="3986169F-00FF-4244-9293-AFBBB3BCE9EA">

			<!-- Remove all files from the INSTALLFOLDER on uninstall -->
			<RemoveFile Id="ALLFILES" Name="*.*" On="both" />

			<!-- Tell WiX to install the Service -->
			<ServiceInstall Id="ServiceInstaller"
                            Type="ownProcess"
                            Name="ThermalSim"
                            DisplayName="$(Name)"
                            Description="ThermalSim service that connects to MSFS2020"
                            Start="auto"
                            ErrorControl="normal" />

			<!-- Tell WiX to start the Service -->
			<ServiceControl Id="StartService"
                            Start="install"
                            Stop="both"
                            Remove="uninstall"
                            Name="ThermalSim"
                            Wait="true" />
		</Component>
	</Package>
</Wix>